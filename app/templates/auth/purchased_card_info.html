{% extends 'base.html' %} {% block title %} purchased cards info {% endblock %} {% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <div class="card shadow-sm mb-4">
                <h2 class="display-4 text-center">Purchased Cards Information</h2>
                <hr>
            </div>
        </div>
    </div>
    <div class="col-md-12">
        Total {{cards.per_page}} of {{cards.total}}
        <table class="table table-hover bg-white table-inverse table-responsive">
            <thead class="thead-inverse">
                <tr>
                    <th>No.</th>
                    <th>Customer Name</th>
                    <th>Serial Number</th>
                    <th>Pin</th>
                    <th>Active</th>
                    <th>Payment Mode</th>
                    <th>Application Type</th>
                    <th>Buyer Email</th>
                    <th>Amount</th>
                    <th>Seller Name</th>
                    <th>Delete</th>

                </tr>
            </thead>
            <tbody>
                {% for card in cards.items %}
                <tr>
                    <td scope="row">{{loop.index}}</td>
                    <td>{{card.buy}}</td>
                    <td>{{card.serial_number}}</td>
                    <td>{{card.pin}}</td>
                    <td>{{card.is_active()}}</td>
                    <td>{{card.buy.payment_mode}}</td>
                    <td>{{card.buy.application_type}}</td>
                    <td>{{card.buy.applicants_email}}</td>
                    <td>{{card.buy.amount}}</td>
                    <td>{{card.buy.admin.username}}</td>
                    <td>
                        <a class="btn btn-danger" href="" id="card">
                            <i class="fas fa-trash-alt"></i>
                            <input type="hidden" id="delete-card" value="{{card.id}}">
                            <input type="hidden" id="delete-buy" value="{{card.buy.id}}">


                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <div class="col-md-12 text-center">
            {% for page_num in cards.iter_pages(left_edge=1,left_current=1,right_current=1,right_edge=1) %} {% if page_num %} {% if page_num == cards.page%}
            <a href="{{ url_for('admin_panel.view_cards',page=page_num ) }}" class="btn btn-info mr-2">{{page_num}}</a> {% else %}
            <a href="{{ url_for('admin_panel.view_cards',page=page_num ) }}" class="btn btn-outline-info mr-2">{{page_num}}</a> {% endif %} {% else %} ... &raquo; {% endif %} {% endfor %}
        </div>
    </div>
</div>
<script>
    var cards = document.querySelectorAll('#card');
    var cardIds = document.querySelectorAll('#delete-card');
    var buyids = document.querySelectorAll('#delete-buy')
    var url = '/admin/delete-purchased-cards/'

    function deleteItem(deleteItems, itemIds, buyids, url) {
        for (const key in deleteItems) {
            if (Object.hasOwnProperty.call(deleteItems, key)) {
                const element = deleteItems[key];
                element.addEventListener('click', function() {
                    let result = confirm('Erase Card Record?');
                    if (result == true) {
                        element.href = url + itemIds[key].value + '/' + buyids[key].value;
                    }
                })
            }
        }
    }

    deleteItem(cards, cardIds, buyids, url);
</script>
{% endblock %}