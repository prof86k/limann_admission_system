{% extends 'base.html' %} {% block title %} create levels {% endblock %} {% block content %}
<div class="container-fluid">
    <div class="card shadow-sm p-2 mb-2">
        <div class="row" style="display: flex; align-items: baseline; justify-content: space-around;">
            <h4>{{department.faculty}}</h4>
            <h1 style="font-size: 24px;">Create Levels</h1>
            <span>
                <!-- Button trigger modal -->
                <button type="button" class="btn btn-success" data-toggle="modal" data-target="#modelId">
                  Add Level
                </button>
                
                <!-- Modal -->
                <div class="modal fade" id="modelId" tabindex="-1" role="dialog" aria-labelledby="modelTitleId" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Add Level</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <form action="{{ url_for('admin_panel.create_level',department_id=department.id) }}" method="post">
            <div class="modal-body">
                {{form.hidden_tag()}}
                <div class="form-group">
                    {% if form.appliction_type.errors %}
                    <div class="alert alert-danger">
                        <button type="button" class="close" data-dismiss="alert">&times;</button> {% for error in form.appliction_type.errors %} {{error}} {% endfor %}
                    </div>
                    {% endif %}
                    <label for="appliction_type">{{form.appliction_type.label()}}</label> {{form.appliction_type(class="form-control")}}
                </div>
                <div class="form-group">
                    {% if form.is_avaliable.errors %}
                    <div class="alert alert-danger">
                        <button type="button" class="close" data-dismiss="alert">&times;</button> {% for error in form.is_avaliable.errors %} {{error}} {% endfor %}
                    </div>
                    {% endif %}
                    <label for="is_avaliable">{{form.is_avaliable.label()}}</label> {{form.is_avaliable()}}
                </div>
            </div>
            <div class="modal-footer">
                {{form.submit(class="btn btn-primary")}}
            </div>
        </form>
    </div>
</div>
</div>
</span>
</div>
<hr class="my-2 bg-danger">
</div>

{% with messages = get_flashed_messages(with_categories=true) %} {% for category,message in messages %}
<div class="alert alert-{{category}} alert-dismissible fade show" role="alert">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button> {{message}}
</div>
{% endfor %} {% endwith %}
    <h2 class="text-center" style="text-transform: capitalize; font-size: 25px;">{{department}}</h2>
    <table class="table table-hover table-inverse table-responsive bg-white">
        <thead class="thead-inverse">
            <tr>
                <th class="col-md-2">Action</th>
                <th class="col-md-2">Level</th>
                <th class="col-md-2">Active</th>
                <th class="col-md-2">Date Started</th>
                <th class="col-md-2">Programmes</th>
            </tr>
        </thead>
        <tbody>
            {% for level in department.types.all() %} {% if level %}
            <tr>
                <td scope="row">
                    <a href="{{ url_for('admin_panel.edit_level',level_id=level.id ) }}" class="btn btn-info btn-sm mb-1">
                        <i class="fas fa-edit"></i>
                    </a>
                    <a href="#" id="levelItems" class="btn btn-sm btn-danger">
                        <i class="fas fa-trash-alt"></i>
                        <input type="hidden" id="levelId" value="{{level.id}}" />
                    </a>
                </td>
                <td><b>{{level|upper}}</b></td>
                <td>{{level.is_avaliable}}</td>
                <td>{{level.date_created}}</td>
                <td>
                    <a href="{{ url_for('admin_panel.create_level_programme',level_id=level.id ) }}" class="btn btn-primary">Add
                                        <i class="fas fa-plus"></i>
                                    </a>
                </td>
            </tr>
            {% else %}
            <p>No Information About This Department</p>
            {% endif %} {% endfor %}
        </tbody>
    </table>
</div>
<script>
    var levelItems = document.querySelectorAll('#levelItems');
    var levelIds = document.querySelectorAll('#levelId');
    var url = '/admin/delete-level/';

    function deleteItem(deleteItems, itemIds, url) {
        for (const key in deleteItems) {
            if (Object.hasOwnProperty.call(deleteItems, key)) {
                const element = deleteItems[key];
                element.addEventListener('click', function() {
                    let result = confirm('Erase Record?');
                    if (result == true) {
                        element.href = url + itemIds[key].value;
                    }
                })
            }
        }
    }
    deleteItem(levelItems, levelIds, url)
</script>
{% endblock %}